<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Althea Development Update #48: Bringing old buildings into the future</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Althea Development Update #48: Bringing old buildings into the future</h1>
</header>
<section data-field="subtitle" class="p-summary">
These last couple of weeks have been an all out code sprint on our way to Alpha 3, productivity is pretty rapid now that the groundwork is…
</section>
<section data-field="body" class="e-content">
<section name="e244" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="4fdd" id="4fdd" class="graf graf--h3 graf--leading graf--title">Althea Development Update #48: Bringing old buildings into the future</h3><p name="4dfa" id="4dfa" class="graf graf--p graf-after--h3">These last couple of weeks have been an all out code sprint on our way to Alpha 3, productivity is pretty rapid now that the groundwork is laid and we’re hitting all but my most optimistic targets.</p><p name="9e52" id="9e52" class="graf graf--p graf-after--p">The big ticket item for alpha3 is enough user setup to actually get things done without the command line. Here’s the development version of the dashboard, you should find it in a nightly <a href="https://github.com/althea-mesh/althea-firmware%27" data-href="https://github.com/althea-mesh/althea-firmware&#39;" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">firmware</a> in the next couple of days.</p><figure name="35dc" id="35dc" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 532px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 76%;"></div><img class="graf-image" data-image-id="1*op57iRVkIAfXvk5K58jUig.png" data-width="2192" data-height="1666" src="https://cdn-images-1.medium.com/max/800/1*op57iRVkIAfXvk5K58jUig.png"></div><figcaption class="imageCaption">The Althea exit server signup screen</figcaption></figure><p name="9318" id="9318" class="graf graf--p graf-after--figure graf--trailing">If you don’t have any OpenWRT capable devices lying around the Linux <a href="https://github.com/althea-mesh/installer" data-href="https://github.com/althea-mesh/installer" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">installer</a> is in far better shape than it was just a week ago and should be easy to play around with. It should be as easy as plugging in an RPI and running the Ansible script. As always hit me up @ttk2 in our <a href="https://riot.im/app/#/room/#althea:matrix.org" data-href="https://riot.im/app/#/room/#althea:matrix.org" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">development chat</a>. Even simple problems are important because they let us know what we need to explain better in our documentation.</p></div></div></section><section name="0471" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="b327" id="b327" class="graf graf--figure graf--leading"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 340px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 48.6%;"></div><img class="graf-image" data-image-id="1*kJwYuDHRBipgTmfbqzfCqg.jpeg" data-width="2016" data-height="980" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*kJwYuDHRBipgTmfbqzfCqg.jpeg"></div><figcaption class="imageCaption">Portland mesh planning</figcaption></figure><p name="1440" id="1440" class="graf graf--p graf-after--figure">Our outreach efforts continue to line up locations for Althea deployments. Deborah has been developing groups in several cities as well as a playbook on how to connect various types of homes.</p><figure name="a494" id="a494" class="graf graf--figure graf--startsWithSingleQuote graf--layoutOutsetLeft graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 525px; max-height: 528px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100.6%;"></div><img class="graf-image" data-image-id="1*mEVIfDA7wp0Uy0fzhhLZmg.jpeg" data-width="2604" data-height="2620" src="https://cdn-images-1.medium.com/max/600/1*mEVIfDA7wp0Uy0fzhhLZmg.jpeg"></div><figcaption class="imageCaption">‘Reverse tower’ strategy for dense housing</figcaption></figure><p name="6121" id="6121" class="graf graf--p graf-after--figure">Where internal wiring is unavailable or of low quality a ‘reverse tower’ setup can provide building residents 100mb or greater at a tiny fraction of the cost to rewire the building.</p><p name="c8ba" id="c8ba" class="graf graf--p graf-after--p">If buildings have unused phone lines or coaxial cable they can be used to provide short distance gigabit speeds using G.Fast hardware, we’ve been working with a vendor for a solution around $100 per unit.</p><p name="127e" id="127e" class="graf graf--p graf-after--p">Of course for a lot of older buildings the picture of in-wall-copper isn’t so pretty. After snooping around several apartment buildings wiring cabinets. I found that arrangements like the one below are pretty common. This ~600 unit building had at-minimum 100 units on a single unamplified input cable line. With a tree of unpowered splitters per floor, down the hallway, and finally per unit.</p><figure name="9f74" id="9f74" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 839px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 119.9%;"></div><img class="graf-image" data-image-id="1*CNw-TZNIoOC2GcAqaKBrkQ.jpeg" data-width="2451" data-height="2939" src="https://cdn-images-1.medium.com/max/800/1*CNw-TZNIoOC2GcAqaKBrkQ.jpeg"></div><figcaption class="imageCaption">Without easily available power trees of signal killing splitters are common</figcaption></figure><p name="7ddc" id="7ddc" class="graf graf--p graf-after--figure">Units in this building are lucky to get 20mbps out of their cable modems. Each splitter attenuates the signal and without a powered amplifier and modems struggle to compensate with slower encoding and heavy use of slow error correcting.</p><p name="cd3b" id="cd3b" class="graf graf--p graf-after--p">After some study and brainstorming I think we could get the whole building to gigabit speeds for less than $200 a unit. By using power adapters in each unit that sent power back up the lines powered splitters could be placed into each box. Reducing signal degradation and allowing each unit to use the full line capacity.</p><p name="3585" id="3585" class="graf graf--p graf-after--p">After that it’s a matter of cutting a few levels off of the tree and dropping in routers per floor or at least per wing to bring the oversale ratio down.</p><p name="41ad" id="41ad" class="graf graf--p graf-after--p">Installations in single family homes are more a matter of land layout than anything else. It’s all about height and line of sight with none of the tricks you can pull in denser living situations. That being said the lack of having to rent roof space really helps.</p><figure name="6fdf" id="6fdf" class="graf graf--figure graf--layoutOutsetLeft graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 525px; max-height: 255px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 48.6%;"></div><img class="graf-image" data-image-id="1*G7IICgOYZwKUcylpBax1Kg.jpeg" data-width="2016" data-height="980" src="https://cdn-images-1.medium.com/max/600/1*G7IICgOYZwKUcylpBax1Kg.jpeg"></div><figcaption class="imageCaption">Althea installation for a single family home</figcaption></figure><p name="f7dc" id="f7dc" class="graf graf--p graf-after--figure graf--trailing">All of these potential mesh groups are a little different, some have backhaul but lack a solid customer group, others are the opposite. Some are municipal internet advocates trying to make local cooperatives. We’ve been working with our contacts to make sure that each of them are successful.</p></div></div></section><section name="9c61" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="1ea8" id="1ea8" class="graf graf--p graf--leading">All this development has led to a few interesting bugs to chase. On the EdgerouterX I’m chasing a bug with <a href="https://wiki.openwrt.org/doc/techref/filesystems" data-href="https://wiki.openwrt.org/doc/techref/filesystems" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">UBIFS</a> where UCI config files become corrupt without a explicit call to ‘sync’. I’m on the verge of just putting a hack into the startup script for this, but I’m going to spend a few more hours trying to track it back to the source.</p><p name="cd35" id="cd35" class="graf graf--p graf-after--p">In trying to get the Edgerouter Lite working I tracked down a bug in Rust’s generated assembly code the assumption of <a href="https://github.com/rust-lang/rust/issues/50890" data-href="https://github.com/rust-lang/rust/issues/50890" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">hard FPU support </a>seems to be a recurring theme in the cross architecture toolchains they have available.</p><figure name="2500" id="2500" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 253px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 36.1%;"></div><img class="graf-image" data-image-id="1*QG7qDFtLA83VIE6a0qxpPA.png" data-width="1941" data-height="701" src="https://cdn-images-1.medium.com/max/800/1*QG7qDFtLA83VIE6a0qxpPA.png"></div><figcaption class="imageCaption">One of these things doesn’t belong</figcaption></figure><p name="168e" id="168e" class="graf graf--p graf-after--figure">I also spent about 4 hours hardening the exit installer playbook for what turned out to be a local hardware issue. My Gil.iNet ar750’s wan port started flaking out and producing 70% packet loss at all times, this resulted in me seeing the negotiation packets on each end but not realizing the session was being screwed up by lost packets.</p><p name="c648" id="c648" class="graf graf--p graf-after--p graf--trailing">While there are still plenty of strange bugs floating around we’ve reached the point where the nightlies tend to work more often than they don’t. Putting us well on the way to a truly stable release.</p></div></div></section>
</section>
<footer><p class="p-tags">Tagged in <a href="https://medium.com/tag/tech" class="p-tag">Tech</a>, <a href="https://medium.com/tag/rust" class="p-tag">Rust</a>, <a href="https://medium.com/tag/mesh-networks" class="p-tag">Mesh Networks</a>, <a href="https://medium.com/tag/diy" class="p-tag">DIY</a></p><p>By <a href="https://medium.com/@kilpatrickjustin" class="p-author h-card">Justin Kilpatrick</a> on <a href="https://medium.com/p/d086eef1b39f"><time class="dt-published" datetime="2018-05-19T14:38:42.752Z">May 19, 2018</time></a>.</p><p><a href="https://medium.com/@kilpatrickjustin/althea-development-update-48-bringing-old-buildings-into-the-future-d086eef1b39f" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on January 9, 2019.</p></footer></article></body></html>